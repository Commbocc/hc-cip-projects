var J=Object.defineProperty,x=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var $=(e,r,a)=>r in e?J(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a,m=(e,r)=>{for(var a in r||(r={}))O.call(r,a)&&$(e,a,r[a]);if(A)for(var a of A(r))q.call(r,a)&&$(e,a,r[a]);return e},g=(e,r)=>x(e,I(r));import{_ as s,$ as o,bb as b,bz as p,I as E,W as F,H as v,a0 as R,ap as z,c8 as C,E as H,P as K,J as M,ay as Q,N as T}from"./vendor.b8b0b9ef.js";import{a as V,u as d,d as W,b as Z,p as _,o as D}from"./networkService.50c5d234.js";import{v as G}from"./normalizeUtils.7353462f.js";import{o as L}from"./utils.931ca8bb.js";import{l as U}from"./Task.b8d888f6.js";import"./GPMessage.9d5ad170.js";function S(e){return e.features.map(r=>{const a=M.fromJSON(e.spatialReference),l=v.fromJSON(r);return Q(l.geometry).spatialReference=a,l})}function B(e){return C(e.features.map(r=>(H(r.geometry)&&(r.geometry.spatialReference=e.spatialReference),K(r.geometry))))}let t=class extends z{constructor(e){super(e),this.facilities=null,this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.serviceAreaPolylines=null,this.serviceAreaPolygons=null}readFacilities(e){return B(e)}readPointBarriers(e,r){return B(r.barriers)}readPolylineBarriers(e){return B(e)}readPolygonBarriers(e){return B(e)}readIncidents(e,r){return S(r.saPolylines)}readServiceAreaPolygons(e,r){return S(r.saPolygons)}};s([o({type:[b]})],t.prototype,"facilities",void 0),s([p("facilities")],t.prototype,"readFacilities",null),s([o({type:[V]})],t.prototype,"messages",void 0),s([o({type:[b]})],t.prototype,"pointBarriers",void 0),s([p("pointBarriers",["barriers"])],t.prototype,"readPointBarriers",null),s([o({type:[E]})],t.prototype,"polylineBarriers",void 0),s([p("polylineBarriers")],t.prototype,"readPolylineBarriers",null),s([o({type:[F]})],t.prototype,"polygonBarriers",void 0),s([p("polygonBarriers")],t.prototype,"readPolygonBarriers",null),s([o({type:[v]})],t.prototype,"serviceAreaPolylines",void 0),s([p("serviceAreaPolylines",["saPolylines"])],t.prototype,"readIncidents",null),s([o({type:[v]})],t.prototype,"serviceAreaPolygons",void 0),s([p("serviceAreaPolygons",["saPolygons"])],t.prototype,"readServiceAreaPolygons",null),t=s([R("esri.rest.support.ServiceAreaSolveResult")],t);const X=t,Y=D({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,defaultBreaks:!0,facilities:!0,outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},returnPointBarriers:{name:"returnBarriers"},travelMode:!0});async function rr(e,r,a){const l=[],u=[],n={},y={},P=L(e),{path:h}=P;r.facilities&&r.facilities.features&&d(r.facilities.features,u,"facilities.features",n),r.pointBarriers&&r.pointBarriers.features&&d(r.pointBarriers.features,u,"pointBarriers.features",n),r.polylineBarriers&&r.polylineBarriers.features&&d(r.polylineBarriers.features,u,"polylineBarriers.features",n),r.polygonBarriers&&r.polygonBarriers.features&&d(r.polygonBarriers.features,u,"polygonBarriers.features",n);const N=await G(u);for(const i in n){const c=n[i];l.push(i),y[i]=N.slice(c[0],c[1])}if(W(y,l)){let i=null;try{i=await Z(h,r.apiKey,a)}catch{}i&&!i.hasZ&&_(y,l)}for(const i in y)y[i].forEach((c,w)=>{r.get(i)[w].geometry=c});const k=g(m({},a),{query:g(m(m({},P.query),Y.toQueryParams(r)),{f:"json"})}),{data:j}=await T(`${h}/solveServiceArea`,k);return X.fromJSON(j)}let f=class extends U{constructor(e){super(e),this.url=null}solve(e,r){return rr(this.url,e,r)}};s([o()],f.prototype,"url",void 0),f=s([R("esri.tasks.ServiceAreaTask")],f);const nr=f;export{nr as default};
